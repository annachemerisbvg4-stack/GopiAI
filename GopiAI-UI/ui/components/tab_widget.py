"""
Tab Widget Component –¥–ª—è GopiAI Standalone Interface
================================================

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
"""

from PySide6.QtWidgets import QWidget, QVBoxLayout, QTabWidget, QTextEdit


class TabDocumentWidget(QWidget):
    """–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"""
    
    def __init__(self, parent=None):
        super().__init__(parent)
        self.setObjectName("tabDocument")
        self._setup_ui()

    def _setup_ui(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤–∫–ª–∞–¥–æ–∫"""
        layout = QVBoxLayout(self)
        layout.setContentsMargins(0, 0, 0, 0)
        
        # –í–∏–¥–∂–µ—Ç –≤–∫–ª–∞–¥–æ–∫
        self.tab_widget = QTabWidget()
        self.tab_widget.setTabsClosable(True)
        self.tab_widget.setMovable(True)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É
        welcome_tab = QTextEdit()
        welcome_tab.setPlainText("""
üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ GopiAI v0.2.0!

–≠—Ç–æ –º–æ–¥—É–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ò–ò –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º.

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
‚Ä¢ üìÅ –ü—Ä–æ–≤–æ–¥–Ω–∏–∫ —Ñ–∞–π–ª–æ–≤ (–ª–µ–≤–∞—è –ø–∞–Ω–µ–ª—å)
‚Ä¢ üìù –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞ —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ (—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å)
‚Ä¢ ü§ñ –ò–ò —á–∞—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç (–ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å)  
‚Ä¢ üíª –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª (–Ω–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å)
‚Ä¢ üé® –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å —Ç–µ–º–Ω–æ–π —Ç–µ–º–æ–π

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—é "–§–∞–π–ª" –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–ª–∏ "–í–∏–¥" –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–Ω–µ–ª—è–º–∏.

–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –∫–æ–º–∞–Ω–¥–æ–π GopiAI
        """)
        welcome_tab.setReadOnly(True)
        
        self.tab_widget.addTab(welcome_tab, "üè† –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å")
        layout.addWidget(self.tab_widget)

    def add_new_tab(self, title="–ù–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç", content=""):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏"""
        editor = QTextEdit()
        editor.setPlainText(content)
        index = self.tab_widget.addTab(editor, title)
        self.tab_widget.setCurrentIndex(index)
        return editor

    def close_current_tab(self):
        """–ó–∞–∫—Ä—ã—Ç–∏–µ —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–∏"""
        current_index = self.tab_widget.currentIndex()
        if current_index >= 0 and self.tab_widget.count() > 1:
            self.tab_widget.removeTab(current_index)

    def get_current_editor(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞"""
        current_widget = self.tab_widget.currentWidget()
        if isinstance(current_widget, QTextEdit):
            return current_widget
        return None

    def get_current_text(self) -> str:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–∏"""
        editor = self.get_current_editor()
        if editor:
            return editor.toPlainText()
        return ""

    def set_current_text(self, text: str):
        """–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ –≤ —Ç–µ–∫—É—â—É—é –≤–∫–ª–∞–¥–∫—É"""
        editor = self.get_current_editor()
        if editor:
            editor.setPlainText(text)
