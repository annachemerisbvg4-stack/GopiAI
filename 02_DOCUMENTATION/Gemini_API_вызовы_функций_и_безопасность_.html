<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 25.2.5.2 (Windows)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="2025-07-24T05:12:46.526980600"/>
	<style type="text/css">
		@page { size: 21.59cm 27.94cm; margin: 2.54cm }
		p { line-height: 115%; text-align: left; margin-bottom: 0.25cm; orphans: 0; widows: 0; direction: ltr; background: transparent }
		h1 { line-height: 100%; text-align: left; orphans: 0; widows: 0; margin-bottom: 0.42cm; border: none; padding: 0cm; direction: ltr; background: transparent }
		h1.western { font-size: 24pt; font-style: normal; font-weight: bold }
		h1.cjk { font-size: 24pt; font-style: normal; font-weight: bold }
		h1.ctl { font-size: 24pt }
		h2 { line-height: 100%; text-align: left; orphans: 0; widows: 0; margin-top: 0.4cm; margin-bottom: 0.4cm; border: none; padding: 0cm; direction: ltr; background: transparent }
		h2.western { font-size: 18pt; font-style: normal; font-weight: bold }
		h2.cjk { font-size: 18pt; font-style: normal; font-weight: bold }
		h2.ctl { font-size: 18pt }
		h3 { line-height: 100%; text-align: left; orphans: 0; widows: 0; margin-bottom: 0.42cm; border: none; padding: 0cm; direction: ltr; background: transparent }
		h3.western { font-size: 14pt; font-style: normal; font-weight: bold }
		h3.cjk { font-size: 14pt; font-style: normal; font-weight: bold }
		h3.ctl { font-size: 14pt }
		h4 { line-height: 100%; text-align: left; orphans: 0; widows: 0; margin-top: 0.45cm; margin-bottom: 0.45cm; border: none; padding: 0cm; direction: ltr; background: transparent }
		h4.western { font-size: 12pt; font-style: normal; font-weight: bold }
		h4.cjk { font-size: 12pt; font-style: normal; font-weight: bold }
		h4.ctl { font-size: 12pt }
	</style>
</head>
<body lang="en-IN" link="#000080" vlink="#800000" dir="ltr"><h1 lang="zxx" class="western" style="border: none; padding: 0cm; background: transparent">
Настройка вызовов функций Gemini API для
взаимодействия с файловой системой в
Python: Устранение проблем безопасности</h1>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
В данном отчете рассматривается общая
проблема, с которой сталкиваются
разработчики Python при интеграции Gemini
API: кажущийся отказ модели выполнять
задачи, связанные с файловой системой,
часто ссылаясь на «настройки безопасности».
Наша цель — прояснить врожденные
возможности и ограничения Gemini, а также
предоставить надежную основу для
безопасной обработки взаимодействий
с файловой системой в пользовательском
приложении Python с использованием мощной
функции вызова функций.</p>
<p lang="zxx" style="margin-bottom: 0.4cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Крайне важно с самого начала понимать,
что Gemini работает в высокозащищенной,
изолированной среде. Ее «настройки
безопасности» в первую очередь связаны
с безопасностью контента и присущими
ограничениями ее внутренней среды
выполнения, а не с прямыми разрешениями
доступа к файлам на уровне операционной
системы. Это различие имеет первостепенное
значение для правильной настройки
приложения и эффективного устранения
любых возникающих проблем.</p>
<h2 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; margin-bottom: 0.42cm; border: none; padding: 0cm; background: transparent">
Понимание взаимодействия Gemini с файловой
системой</h2>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Основной принцип: Gemini не имеет прямого
доступа к вашей локальной файловой
системе</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Модели Gemini по своей конструкции работают
в безопасной, изолированной среде и <b>не
имеют прямого доступа к файловой системе
вашей локальной машины</b>. Это
фундаментальная мера безопасности,
реализованная Google для защиты вашей
системы от потенциальных уязвимостей
и несанкционированного доступа к данным.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Даже экспериментальная функция Gemini
«Выполнение кода», доступная в моделях
Gemini 2.0, работает в песочнице Python и явно
«не может запускать веб-серверы, получать
доступ к файловой системе или выполнять
сетевые операции». Ее назначение —
выполнять вычисления, анализировать
сложные наборы данных и отлаживать код,
<i>предоставленный в контексте чата</i>,
а не взаимодействовать со средой хоста,
где работает ваше приложение.</p>
<p lang="zxx" style="margin-bottom: 0.42cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Воспринимаемый пользователем «отказ»
Gemini выполнять задачи файловой системы
из-за «настроек безопасности» является
неверным толкованием. Отказ связан не
с <i>разрешениями доступа к файловой
системе</i> со стороны Gemini, а скорее с
<i>политиками безопасности контента</i>,
применяемыми к <i>данным</i>, передаваемым
в Gemini, или с присущими <i>ограничениями
внутренней песочницы выполнения кода
Gemini</i>, которая явно <i>не допускает</i>
доступа к файловой системе. Это означает,
что проблема заключается не в том, что
Gemini требуется разрешение на доступ к
файлам, а в том, что Gemini блокирует контент
или описания действий на основе своих
политик безопасности или собственных
архитектурных ограничений.</p>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Вызов функций как мост: ваше приложение
как исполнитель</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Вызов функций — это мощная функция,
которая позволяет языковой модели
взаимодействовать с внешними системами
и API. Разработчики создают описания
функций (часто называемых «инструментами»)
в своем коде, которые затем передаются
языковой модели в запросе.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<b>Важно отметить, что Gemini сама не выполняет
эти функции.</b> Вместо этого она анализирует
ваш запрос и определяет, нужен ли
определенный инструмент для выполнения
запроса. Если она решает использовать
инструмент, она генерирует объект
FunctionCall (структурированный вывод JSON),
содержащий имя функции и аргументы для
ее вызова.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Ваше приложение Python, в частности,
использующее ChatSession из SDK Gemini (в котором
automatic_function_calling включен по умолчанию),
затем получает этот FunctionCall. SDK найдет
соответствующую функцию Python, которую
вы определили, <i>выполнит ее на вашей
локальной машине</i> и отправит возвращаемое
значение функции обратно в модель в
виде FunctionResponse.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Этот многооборотный диалог идеально
подходит для создания динамичных и
интерактивных приложений на основе ИИ.
Ваше приложение выступает в качестве
безопасного посредника, переводя
интеллектуальные рассуждения Gemini в
реальные действия, такие как взаимодействие
с вашей локальной файловой системой.</p>
<p lang="zxx" style="margin-bottom: 0.42cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Вызов функций действует как безопасный
уровень абстракции. Gemini <i>декларирует
намерение</i> (например, «Мне нужно
прочитать файл X»), но приложение Python
сохраняет полный контроль и ответственность
за то, <i>как</i> это намерение будет
выполнено, включая все последствия для
безопасности взаимодействия с локальной
средой. Такая конструкция по своей сути
предотвращает прямой компрометацию
хост-системы со стороны LLM. Разделение
задач — это фундаментальный принцип
безопасности, который не позволяет LLM
иметь произвольный доступ к хост-системе.</p>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Files API для мультимодального ввода:
загрузка данных в инфраструктуру Google</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Для обработки больших или мультимодальных
входных данных (включая текст, изображения,
аудио, видео и документы) Gemini API
предоставляет специальный <b>Files API</b>.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Этот API позволяет загружать медиафайлы
в инфраструктуру Google, где они безопасно
хранятся в течение 48 часов. После загрузки
вы можете ссылаться на эти файлы по их
уникальному идентификатору в вызовах
generateContent, что позволяет Gemini обрабатывать
их содержимое.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Files API особенно полезен для запросов,
где общий размер (включая файлы, текстовый
запрос и т. д.) превышает 20 МБ. Он
поддерживает хранение до 20 ГБ файлов
на проект, с максимальным размером файла
2 ГБ.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<b>Важно отметить, что, хотя вы можете
получить метаданные о загруженных
файлах, вы не можете загружать сами
файлы через Files API</b>. Это подтверждает,
что это механизм для безопасной передачи
входных данных <i>в</i> Gemini для обработки,
а не для того, чтобы Gemini инициировала
загрузку <i>на</i> вашу локальную систему.</p>
<p lang="zxx" style="margin-bottom: 0.4cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Files API является безопасным механизмом
для предоставления больших, мультимодальных
входных данных Gemini путем их размещения
в облачном хранилище Google, а не прямым
мостом для Gemini для доступа к локальной
файловой системе пользователя. Этот
выбор дизайна усиливает безопасность
данных и масштабируемость, но означает,
что приложение пользователя должно
управлять начальным процессом загрузки.
Ответственность за обработку локальных
файлов и их первоначальную загрузку
полностью лежит на приложении пользователя.</p>
<h2 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; margin-bottom: 0.42cm; border: none; padding: 0cm; background: transparent">
Устранение отказов, связанных с
«настройками безопасности»</h2>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Встроенные фильтры безопасности Gemini:
модерация контента, а не разрешения ОС</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Gemini API включает в себя надежные <b>настройки
безопасности</b> для фильтрации контента,
включая как запросы, так и сгенерированные
ответы, которые могут быть вредоносными.
Эти фильтры категоризируют уровень
вероятности того, что контент является
небезопасным, по нескольким измерениям,
определяемым HarmCategory:</p>
<ul>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	HARM_CATEGORY_HARASSMENT (Притеснение)</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	HARM_CATEGORY_HATE_SPEECH (Разжигание ненависти)</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	HARM_CATEGORY_SEXUALLY_EXPLICIT (Явный сексуальный
	контент)</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	HARM_CATEGORY_DANGEROUS_CONTENT (Опасный контент)</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	HARM_CATEGORY_CIVIC_INTEGRITY (Гражданская
	добросовестность)</p></li>
</ul>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Контент блокируется на основе <i>вероятности</i>
(НЕЗНАЧИТЕЛЬНАЯ, НИЗКАЯ, СРЕДНЯЯ, ВЫСОКАЯ)
того, что он небезопасен, а не обязательно
его серьезности. Это означает, что
контент с низкой серьезностью, но высокой
вероятностью вреда все равно может быть
заблокирован.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
По умолчанию модели Gemini API блокируют
контент (включая запросы) со средней
или более высокой вероятностью быть
небезопасным по любому фильтру. Этот
базовый уровень предназначен для
большинства случаев использования, и
корректировки следует вносить осторожно
и только в том случае, если это постоянно
требуется для конкретных потребностей
вашего приложения.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
«Настройки безопасности», на которые
ссылается Gemini, в первую очередь являются
фильтрами безопасности контента. Хотя
они критически важны для ответственного
использования ИИ, они отличаются от
разрешений доступа к файлам на уровне
операционной системы. Проблема
пользователя, скорее всего, связана с
тем, что:</p>
<ol>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<i>Содержимое</i> файлов (или <i>запрос</i>
	на взаимодействие с файлами) помечается
	как потенциально вредоносное (например,
	вредоносный код, конфиденциальные
	данные или даже просто текст, который
	попадает в категорию «опасный»).</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Непонимание присущих Gemini архитектурных
	ограничений в отношении прямого доступа
	к файловой системе.</p></li>
</ol>
<p lang="zxx" style="margin-bottom: 0.42cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Это означает, что модель не отказывает
в <i>доступе</i> к локальному файлу, а
скорее отказывает в <i>обработке</i> или
<i>генерации контента</i> о том, что она
воспринимает как небезопасный <i>ввод</i>.</p>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Почему ваш запрос может быть заблокирован
(связано с содержимым файла)</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Если вы передаете содержимое локальных
файлов в Gemini (например, фрагменты кода,
конфиденциальные документы или
инструкции, включающие потенциально
рискованные операции), само содержимое
или запрос, описывающий его, могут
вызвать срабатывание этих фильтров
безопасности.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Например, запрос к Gemini «обобщи этот
скрипт, который удаляет все файлы в
каталоге», скорее всего, будет помечен
как HARM_CATEGORY_DANGEROUS_CONTENT, даже если ваше
приложение предназначено для предотвращения
фактического удаления. Фильтры Gemini
работают с <i>текстовым представлением</i>
намерения или содержимого.</p>
<p lang="zxx" style="margin-bottom: 0.42cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Аналогично, если содержимое файла
содержит конфиденциальную личную
информацию или проприетарные данные,
которые внутренние фильтры Gemini считают
неприемлемыми для обработки или
генерации, оно может быть заблокировано.</p>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Настройка параметров безопасности (с
осторожностью)</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Вы можете изменять настройки безопасности
при отправке запроса к Gemini API с помощью
Python SDK. Это делается путем передачи
списка объектов SafetySetting в параметр
safety_settings вашего экземпляра GenerativeModel или
вызова generate_content.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Каждый SafetySetting указывает HarmCategory и
HarmBlockThreshold.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<b>Пример конфигурации Python SDK (концептуальный):</b></p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<font face="Courier, serif">import google.generativeai as genai<br/>
from
google.generativeai.types import HarmCategory, HarmBlockThreshold<br/>
<br/>
#
Настройте свой
API-ключ<br/>
genai.configure(api_key=&quot;ВАШ_API_КЛЮЧ&quot;)<br/>
<br/>
#
Определите пользовательские настройки
безопасности<br/>
# Этот пример устанавливает
для 'Опасного контента' блокировку
только контента с ВЫСОКОЙ вероятностью,<br/>
#
а для 'Притеснения' - блокировку контента
с НИЗКОЙ и выше вероятностью.<br/>
custom_safety_settings
=<br/>
<br/>
model = genai.GenerativeModel(<br/>
   
model_name=&quot;gemini-1.5-flash&quot;, # Или выбранная
вами модель (например, gemini-1.5-pro)<br/>
   
safety_settings=custom_safety_settings<br/>
)<br/>
<br/>
# Теперь
используйте этот экземпляр модели для
генерации контента или взаимодействия
в чате<br/>
# chat = model.start_chat(history=)<br/>
# response
= chat.send_message(&quot;Пожалуйста, проанализируйте
содержимое скрипта из файла.&quot;)<br/>
</font><br/>

</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<b>Важные соображения:</b></p>
<ul>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Условия использования:</b> Изменение
	настроек безопасности на менее строгие
	может повлечь за собой проверку вашего
	приложения и должно строго соответствовать
	Условиям использования Gemini API и Политике
	запрещенного использования генеративного
	ИИ.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Ответственный ИИ:</b> Всегда отдавайте
	приоритет безопасности пользователей
	и этичному развитию ИИ. Менее строгие
	настройки могут привести к генерации
	или обработке небезопасного, предвзятого
	или иным образом неприемлемого контента.
	Тщательное тестирование и человеческий
	надзор имеют первостепенное значение.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Не предоставление разрешений файловой
	системе:</b> Крайне важно еще раз
	подчеркнуть, что изменение этих настроек
	<i>не</i> предоставит Gemini прямой доступ
	к вашей локальной файловой системе.
	Оно лишь изменяет то, как Gemini обрабатывает
	или генерирует контент на основе своих
	внутренних классификаторов безопасности,
	которые могут интерпретировать контент,
	связанный с файлами (или запросы о нем),
	как вредоносный.</p></li>
</ul>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<b>Таблица: Категории безопасности и
пороги блокировки Gemini API</b></p>
<table width="624" cellpadding="0" cellspacing="0">
	<col width="207"/>
	<col width="208"/>
	<col width="207"/>
	<thead>
		<tr valign="top">
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Категория вреда (HarmCategory)</p>
			</td>
			<td width="208" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Порог блокировки (HarmBlockThreshold)</p>
			</td>
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Описание</p>
			</td>
		</tr>
	</thead>
	<tbody>
		<tr valign="top">
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				HARM_CATEGORY_HARASSMENT</p>
			</td>
			<td width="208" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				BLOCK_NONE</p>
			</td>
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Всегда показывать независимо от
				вероятности небезопасного контента</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" align="left" style="border: none; padding: 0cm; orphans: 0; widows: 0; page-break-inside: auto; background: transparent; page-break-after: auto">
				<br/>

				</p>
			</td>
			<td width="208" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				BLOCK_ONLY_HIGH</p>
			</td>
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Блокировать при высокой вероятности
				небезопасного контента</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" align="left" style="border: none; padding: 0cm; orphans: 0; widows: 0; page-break-inside: auto; background: transparent; page-break-after: auto">
				<br/>

				</p>
			</td>
			<td width="208" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				BLOCK_MEDIUM_AND_ABOVE</p>
			</td>
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Блокировать при средней или высокой
				вероятности небезопасного контента</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" align="left" style="border: none; padding: 0cm; orphans: 0; widows: 0; page-break-inside: auto; background: transparent; page-break-after: auto">
				<br/>

				</p>
			</td>
			<td width="208" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				BLOCK_LOW_AND_ABOVE</p>
			</td>
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Блокировать при низкой, средней или
				высокой вероятности небезопасного
				контента</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" align="left" style="border: none; padding: 0cm; orphans: 0; widows: 0; page-break-inside: auto; background: transparent; page-break-after: auto">
				<br/>

				</p>
			</td>
			<td width="208" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				HARM_BLOCK_THRESHOLD_UNSPECIFIED</p>
			</td>
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Порог не указан, блокировать с
				использованием порога по умолчанию</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				HARM_CATEGORY_HATE_SPEECH</p>
			</td>
			<td width="208" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				(Те же пороги)</p>
			</td>
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Контент, который является грубым,
				неуважительным или нецензурным</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				HARM_CATEGORY_SEXUALLY_EXPLICIT</p>
			</td>
			<td width="208" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				(Те же пороги)</p>
			</td>
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Содержит ссылки на сексуальные
				действия или другой непристойный
				контент</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				HARM_CATEGORY_DANGEROUS_CONTENT</p>
			</td>
			<td width="208" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				(Те же пороги)</p>
			</td>
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Продвигает, облегчает или поощряет
				вредоносные действия</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				HARM_CATEGORY_CIVIC_INTEGRITY</p>
			</td>
			<td width="208" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				(Те же пороги)</p>
			</td>
			<td width="207" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Запросы, связанные с выборами</p>
			</td>
		</tr>
	</tbody>
</table>
<p lang="zxx" style="margin-bottom: 0.42cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<i>Примечание: По умолчанию для
gemini-1.5-pro-002, gemini-1.5-flash-002 и всех более новых
стабильных GA-моделей порог блокировки
установлен на Block none для всех категорий,
кроме Civic integrity. Для других моделей по
умолчанию используется Block some.</i></p>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Отличие от режима агента Gemini Code Assist</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Важно различать общий Gemini API (который
использует ваше пользовательское
приложение Python) и конкретные продукты
Google, такие как <b>«режим агента» Gemini Code
Assist</b>.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Режим агента, обычно интегрированный
в IDE, такие как VS Code или JetBrains, <i>действительно</i>
предлагает контролируемое взаимодействие
с файловой системой через встроенные
инструменты (например, grep, terminal, file read,
file write). Для операций, которые изменяют
файловую систему или выполняют «мутирующие
операции», режим агента явно «попросит
вас разрешить операцию, если вы не
настроили Gemini на постоянное разрешение
инструмента или инструментов».</p>
<p lang="zxx" style="margin-bottom: 0.4cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Режим агента Gemini Code Assist обеспечивает
контролируемое взаимодействие с файловой
системой на основе разрешений <i>в
контексте IDE</i>. Это специализированная
функция конкретного продукта Google, а не
общая возможность основного Gemini API для
пользовательских приложений. Разработчику
Python, создающему пользовательское
приложение, необходимо самостоятельно
реализовать взаимодействие с файловой
системой в своем приложении, а не ожидать,
что Gemini API волшебным образом получит
прямой доступ к ОС. Это различие
предотвращает бесплодные поиски
несуществующих конфигураций «режима
агента» в стандартной документации
Gemini API для пользовательского приложения.</p>
<h2 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Безопасная реализация операций с
файловой системой в вашем приложении
Python</h2>
<p lang="zxx" style="margin-bottom: 0.42cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Поскольку Gemini не имеет прямого доступа
к вашей файловой системе, ваше приложение
Python должно обрабатывать все операции,
связанные с файлами. Затем вызов функций
позволяет Gemini <i>рассуждать</i> об этих
операциях, а вашему приложению —
<i>выполнять</i> их в своей контролируемой
среде.</p>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Определение функций Python для файловых
операций</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Вы будете определять стандартные функции
Python, которые выполняют желаемые задачи
файловой системы, такие как чтение,
запись, вывод списка каталогов или
сжатие файлов. Эти функции будут
использовать встроенные модули Python,
такие как os, io, zipfile, shutil и т. д.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
SDK google-generativeai автоматически преобразует
имя, docstring и аннотации типов вашей функции
Python в FunctionDeclaration, которую модель может
понять. Крайне важно убедиться, что ваши
docstring четкие и точно описывают назначение,
параметры и возвращаемые значения
функции, поскольку Gemini использует эту
информацию для принятия решения о том,
когда и как вызывать ваши инструменты.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<b>Пример: Чтение локального текстового
файла</b></p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<font face="Courier, serif">import os<br/>
import google.generativeai
as genai<br/>
from google.generativeai.types import
FunctionDeclaration<br/>
<br/>
def read_local_text_file(filepath:
str) -&gt; str:<br/>
    &quot;&quot;&quot;<br/>
    Читает
содержимое локального текстового файла
и возвращает его в виде строки.<br/>
<br/>
 
  Args:<br/>
        filepath (str): Абсолютный или
относительный путь к текстовому файлу.<br/>
<br/>

   Returns:<br/>
        str: Содержимое файла или
сообщение об ошибке, если файл<br/>
        
    не может быть прочитан или найден.<br/>

   &quot;&quot;&quot;<br/>
    if not os.path.exists(filepath):<br/>

       return f&quot;Ошибка: Файл не найден по
пути {filepath}&quot;<br/>
    try:<br/>
        with
open(filepath, 'r', encoding='utf-8') as f:<br/>
            content
= f.read()<br/>
        return content<br/>
    except Exception as
e:<br/>
        return f&quot;Ошибка чтения файла
{filepath}: {e}&quot;<br/>
<br/>
# Объявите эту функцию
Gemini как инструмент<br/>
read_file_tool =
FunctionDeclaration.from_callable(read_local_text_file)<br/>
<br/>
#
При инициализации модели или сеанса
чата включите этот инструмент:<br/>
# model
= genai.GenerativeModel(model_name='gemini-1.5-flash',
tools=[read_file_tool])<br/>
# chat =
model.start_chat(enable_automatic_function_calling=True)<br/>
#
response = chat.send_message(&quot;Можете ли вы прочитать
содержимое 'my_document.txt' для меня?&quot;)<br/>
</font><br/>

</p>
<p lang="zxx" style="margin-bottom: 0.42cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Фрагменты предоставляют конкретные
примеры функций Python (extract_text_from_zip,
extract_text_from_single_file), которые демонстрируют,
как выполнять локальные файловые
операции (чтение ZIP-архивов, отдельных
текстовых файлов) с использованием
модулей Python zipfile и open(). Эти примеры служат
отличными шаблонами для реализации
собственных инструментов файловой
системы.</p>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Передача содержимого файла в Gemini через
types.Part (для мультимодального контекста)</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Если фактическое содержимое локального
файла должно быть проанализировано
Gemini как часть запроса (например, анализ
конкретного документа, изображения или
файла кода для проверки), это содержимое
следует преобразовать в объект
genai.types.Part.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Для текстовых файлов используйте
types.Part.from_bytes и укажите правильный
mime_type (например, &quot;text/plain&quot;, &quot;text/x-python&quot;,
&quot;text/javascript&quot;). Это крайне важно для
правильной интерпретации содержимого
Gemini.</p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<b>Пример: Отправка содержимого файла
кода в Gemini для анализа (концептуальный,
на основе ):</b></p>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<font face="Courier, serif">import google.generativeai as genai<br/>
from
google.generativeai.types import Part<br/>
<br/>
def
prepare_file_content_for_gemini(filepath: str, mime_type: str):<br/>

   &quot;&quot;&quot;<br/>
    Читает локальный файл
и подготавливает его содержимое как
объект Part для Gemini.<br/>
<br/>
    Args:<br/>
       
filepath (str): Путь к локальному файлу.<br/>
   
    mime_type (str): MIME-тип файла (например,
&quot;text/x-python&quot;).<br/>
<br/>
    Returns:<br/>
       
Part: Объект genai.types.Part, содержащий содержимое
файла.<br/>
    &quot;&quot;&quot;<br/>
    try:<br/>
       
with open(filepath, &quot;rb&quot;) as f: # Открыть в
бинарном режиме чтения<br/>
           
file_bytes = f.read()<br/>
        # Создать объект Part
из байтов с указанным MIME-типом<br/>
       
file_part = Part.from_bytes(file_bytes, mime_type=mime_type)<br/>
   
    return file_part<br/>
    except Exception as e:<br/>
       
print(f&quot;Ошибка при подготовке файла
{filepath}: {e}&quot;)<br/>
        return None<br/>
<br/>
# Пример
использования после чтения локального
файла кода:<br/>
# file_path = &quot;my_application_code.py&quot;<br/>
#
code_part = prepare_file_content_for_gemini(file_path,
&quot;text/x-python&quot;)<br/>
#<br/>
# if code_part:<br/>
#    
model = genai.GenerativeModel('gemini-1.5-flash')<br/>
#     response
= model.generate_content([code_part, &quot;Проанализируйте
этот код Python на предмет потенциальных
ошибок и предложите улучшения.&quot;])<br/>
#
    print(response.text)<br/>
</font><br/>

</p>
<p lang="zxx" style="margin-bottom: 0.42cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Этот метод отличается от использования
Files API , который предназначен для загрузки
и управления большими медиафайлами в
инфраструктуре Google для повторного
использования в нескольких запросах.
types.Part подходит для включения содержимого
небольших файлов непосредственно в
запрос generateContent как часть непосредственного
контекста разговора.</p>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Лучшие практики для безопасной реализации
инструментов</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Поскольку ваше приложение берет на себя
ответственность за выполнение действий,
предложенных Gemini, крайне важно применять
строгие меры безопасности.</p>
<ul>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Проверка и очистка входных данных:</b>
	Это имеет первостепенное значение.
	Всегда проверяйте и очищайте любые
	аргументы или пути к файлам, полученные
	от FunctionCall Gemini, прежде чем использовать
	их в локальных файловых операциях.
	Никогда не используйте напрямую пути
	или команды, предоставленные LLM, без
	строгой проверки, чтобы предотвратить
	критические уязвимости, такие как обход
	пути, произвольный доступ к файлам или
	внедрение команд. Ваше приложение
	должно обеспечивать разрешенные
	каталоги, типы файлов и типы операций.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Принцип наименьших привилегий:</b>
	Убедитесь, что ваше приложение Python (и
	учетная запись пользователя, под которой
	оно работает) имеет только абсолютно
	минимально необходимые разрешения
	файловой системы. Не предоставляйте
	широкий доступ для чтения/записи, если
	требуются только определенные каталоги
	или типы файлов для функциональности
	приложения.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Изоляция для выполнения ненадежного
	кода:</b> Если ваше приложение предназначено
	для того, чтобы Gemini генерировала <i>код,
	который затем выполняет ваше приложение</i>
	(например, для сложного анализа данных,
	генерации скриптов или сценариев
	отладки), вы <i>должны</i> реализовать
	надежный и безопасный механизм изоляции.</p></li>
</ul>
<ul>
	<ul>
		<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
		Фрагменты подчеркивают критическую
		необходимость изоляции, когда LLM-агенты
		могут писать и выполнять свой собственный
		код. Рекомендуются такие решения, как
		запуск ядра Jupyter Notebook внутри контейнера
		gVisor, для создания изолированных,
		безопасных сред выполнения. gVisor
		действует как ядро пользовательского
		пространства, перехватывая системные
		вызовы и обеспечивая политики
		безопасности, предотвращая влияние
		ненадежного кода на более широкую
		систему. Это важнейший барьер безопасности
		для разработчиков, которые могут
		поддаться искушению разрешить прямое
		выполнение кода, предложенного LLM.</p></li>
	</ul>
</ul>
<ul>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Комплексная обработка ошибок и ведение
	журнала:</b> Реализуйте надежную обработку
	ошибок для всех файловых операций в
	ваших функциях Python. Регистрируйте любое
	неожиданное поведение, попытки доступа
	за пределами разрешенных параметров
	или сбои выполнения функций. Это жизненно
	важно для отладки, выявления потенциального
	неправомерного использования и
	поддержания стабильности вашего
	приложения.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Согласие пользователя и прозрачность:</b>
	Для конфиденциальных файловых операций
	(например, изменение или удаление
	файлов) рассмотрите возможность
	добавления явных запросов на согласие
	пользователя в пользовательском
	интерфейсе вашего приложения перед
	выполнением действий, предложенных
	Gemini. Это добавляет дополнительный
	уровень человеческого надзора и
	прозрачности.</p></li>
</ul>
<h2 lang="zxx" class="western" style="border: none; padding: 0cm; background: transparent">
Устранение распространенных проблем</h2>
<p lang="zxx" style="margin-bottom: 0.42cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Когда Gemini, кажется, «отказывается» от
выполнения задачи, особенно связанной
с файловыми системами, важно систематически
диагностировать проблему. Помимо
рассмотренных фильтров безопасности
контента, несколько других факторов
могут привести к неожиданному поведению
или ошибкам.</p>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
API-ключ и разрешения</h3>
<ul>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Убедитесь, что ваш API-ключ Gemini правильно
	настроен как переменная среды
	(GEMINI_API_KEY) или передан явно клиенту при
	инициализации genai.Client().</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Убедитесь, что ваш API-ключ активен, и,
	если ваше использование превышает
	бесплатный уровень или вы используете
	определенные настроенные модели, что
	для вашего проекта Google Cloud включено
	выставление счетов. Ошибка HTTP 403
	PERMISSION_DENIED часто указывает на неверный
	или недостаточно разрешенный API-ключ.</p></li>
</ul>
<h3 lang="zxx" class="western" style="border: none; padding: 0cm; background: transparent">
Совместимость моделей и ограничения
скорости</h3>
<ul>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Убедитесь, что вы используете
	поддерживаемый и правильный идентификатор
	модели (например, gemini-1.5-flash, gemini-1.5-pro).
	Использование общих или устаревших
	имен (например, «2.5pro», как упоминается
	в ) может привести к ошибкам 404 NOT_FOUND.
	Всегда обращайтесь к последней
	официальной документации для получения
	текущих имен моделей.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Проверьте соответствие вашего приложения
	ограничениям скорости Gemini API (запросы
	в минуту, токены в минуту). Превышение
	этих ограничений приведет к ошибкам
	429 RESOURCE_EXHAUSTED. Реализуйте надежную логику
	повторных попыток с экспоненциальной
	задержкой, если это необходимо, для
	обработки временных проблем с
	ограничениями скорости.</p></li>
</ul>
<h3 lang="zxx" class="western" style="border: none; padding: 0cm; background: transparent">
Отладка вызовов функций</h3>
<ul>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	ChatSession в Python SDK автоматически обрабатывает
	выполнение функций, когда
	automatic_function_calling включен (что является
	поведением по умолчанию).</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Для отладки потока взаимодействия вы
	можете изучить свойство Chat.history. Каждый
	ход в разговоре представлен объектом
	genai.types.Content, который явно покажет объекты
	FunctionCall (запрос модели на выполнение
	вашего инструмента) и FunctionResponse (результат,
	возвращаемый вашим приложением после
	выполнения инструмента). Это поможет
	вам определить, правильно ли Gemini
	идентифицирует функцию для вызова и
	успешно ли ваше приложение ее выполняет
	и возвращает ожидаемый ответ.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Если automatic_function_calling отключен (например,
	{&quot;disable&quot;: True} при создании чата) или
	если вы используете Client.model.generate_content
	напрямую, вам нужно будет вручную
	проверять ответ модели на наличие
	объектов FunctionCall и самостоятельно
	обрабатывать их выполнение и отправку
	ответов.</p></li>
</ul>
<h3 lang="zxx" class="western" style="border: none; padding: 0cm; background: transparent">
Интерпретация кодов ошибок</h3>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
<b>Таблица: Общие коды ошибок Gemini API и их
решения</b></p>
<table width="624" cellpadding="0" cellspacing="0">
	<col width="155"/>
	<col width="156"/>
	<col width="156"/>
	<col width="155"/>
	<thead>
		<tr valign="top">
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				HTTP-код</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Статус</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Описание</p>
			</td>
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Решение</p>
			</td>
		</tr>
	</thead>
	<tbody>
		<tr valign="top">
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				400</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				INVALID_ARGUMENT</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Неверный формат тела запроса; опечатка
				или отсутствует обязательное поле.</p>
			</td>
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Проверьте справочник API на формат
				запроса, примеры и поддерживаемые
				версии. Использование функций из
				более новой версии API с более старой
				конечной точкой может вызвать ошибки.</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				400</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				FAILED_PRECONDITION</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Бесплатный уровень Gemini API недоступен
				в вашей стране или не включено
				выставление счетов.</p>
			</td>
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Включите выставление счетов в вашем
				проекте Google AI Studio. Для использования
				Gemini API потребуется настроить платный
				тарифный план.</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				403</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				PERMISSION_DENIED</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Ваш API-ключ не имеет необходимых
				разрешений.</p>
			</td>
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Убедитесь, что ваш API-ключ настроен
				правильно и имеет необходимые
				разрешения. Убедитесь, что вы прошли
				надлежащую аутентификацию для
				использования настроенных моделей.</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				404</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				NOT_FOUND</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Запрошенный ресурс не найден (например,
				файл, модель).</p>
			</td>
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Проверьте, существуют ли все параметры
				в вашем запросе для вашей версии API.
				Убедитесь, что вы используете
				поддерживаемую модель.</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				429</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				RESOURCE_EXHAUSTED</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Вы превысили лимит скорости запросов.</p>
			</td>
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Убедитесь, что вы находитесь в пределах
				лимита скорости модели. При необходимости
				запросите увеличение квоты.</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				500</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				INTERNAL</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Неожиданная ошибка на стороне Google.</p>
			</td>
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Ваш входной контекст слишком длинный.
				Уменьшите входной контекст или
				временно переключитесь на другую
				модель. Подождите немного и повторите
				запрос.</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				503</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				UNAVAILABLE</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Сервис временно перегружен или
				недоступен.</p>
			</td>
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Сервис временно не имеет достаточной
				мощности. Временно переключитесь на
				другую модель. Подождите немного и
				повторите запрос.</p>
			</td>
		</tr>
		<tr valign="top">
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				504</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				DEADLINE_EXCEEDED</p>
			</td>
			<td width="156" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Сервис не может завершить обработку
				в установленный срок.</p>
			</td>
			<td width="155" style="background: transparent; border: 1.00pt solid #000000; padding: 0cm"><p lang="zxx" style="border: none; padding: 0cm; background: transparent">
				Ваш запрос (или контекст) слишком
				велик для обработки вовремя. Установите
				больший timeout в запросе клиента, чтобы
				избежать этой ошибки.</p>
			</td>
		</tr>
	</tbody>
</table>
<p lang="zxx" style="margin-bottom: 0.4cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
Эти ошибки могут быть связаны с задачами
файловой системы, например, 400
INVALID_ARGUMENT для неправильно сформированных
объектов types.Part, 404 NOT_FOUND, если идентификатор
Files API неверен, или 500 INTERNAL / 504
DEADLINE_EXCEEDED, если большое содержимое файла
приводит к чрезмерной длине контекста.</p>
<h2 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; margin-bottom: 0.42cm; border: none; padding: 0cm; background: transparent">
Заключение и рекомендации</h2>
<h3 lang="zxx" class="western" style="line-height: 100%; margin-top: 0cm; border: none; padding: 0cm; background: transparent">
Ключевые выводы</h3>
<ul>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Gemini API не имеет прямого доступа к вашей
	локальной файловой системе. Все файловые
	операции должны обрабатываться вашим
	приложением Python.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Вызов функций — это безопасный и
	предполагаемый механизм для Gemini, чтобы
	<i>запрашивать</i> действия, которые затем
	<i>выполняет</i> ваше приложение Python
	локально. Эта архитектура обеспечивает
	четкое разделение задач и поддерживает
	безопасность вашей хост-системы.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Отказы Gemini, связанные с «настройками
	безопасности», скорее всего, вызваны
	срабатыванием ее внутренних фильтров
	безопасности контента из-за характера
	запроса или содержимого обрабатываемых
	файлов, а не отсутствием прямых разрешений
	файловой системы.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	Files API — это специальный сервис для
	загрузки больших мультимодальных
	данных в облако Google для обработки
	Gemini, а не инструмент для взаимодействия
	с локальной файловой системой.</p></li>
</ul>
<h3 lang="zxx" class="western" style="border: none; padding: 0cm; background: transparent">
Практические рекомендации для разработчика</h3>
<ol>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Переосмыслите «отказ»:</b> Поймите,
	что Gemini, вероятно, блокирует контент
	на основе своих политик безопасности
	или присущих ей архитектурных ограничений
	(отсутствие прямого доступа к файловой
	системе), а не из-за отсутствия «разрешения»
	на доступ к вашим локальным файлам.
	Этот сдвиг в перспективе имеет решающее
	значение для эффективной отладки.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Определите явные функции Python для
	файловых операций:</b> Реализуйте все
	желаемые взаимодействия с файловой
	системой (чтение, запись, вывод списка
	и т. д.) как надежные функции Python в вашем
	приложении. Убедитесь, что эти функции
	корректно обрабатывают ошибки и
	тщательно проверяют все входные данные.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Правильно объявляйте инструменты
	Gemini:</b> Используйте
	genai.types.FunctionDeclaration.from_callable() для
	предоставления ваших функций Python
	Gemini. Предоставьте четкие, описательные
	docstring и точные аннотации типов, поскольку
	Gemini полагается на них для интеллектуального
	вызова функций.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Управляйте передачей содержимого
	файла в Gemini:</b> Для прямого анализа
	содержимого передавайте содержимое
	файла в Gemini как объекты genai.types.Part с
	правильными MIME-типами. Для более крупных
	медиафайлов используйте специальный
	Files API для загрузки контента в инфраструктуру
	Google, прежде чем ссылаться на него в
	своих запросах.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Внимательно пересмотрите и скорректируйте
	настройки безопасности:</b> Если вы
	подозреваете, что проблема связана с
	фильтрацией контента, внимательно
	изучите категории безопасности Gemini и
	рассмотрите возможность корректировки
	порогов для HARM_CATEGORY_DANGEROUS_CONTENT или других
	соответствующих категорий. Всегда
	действуйте с особой осторожностью,
	строго соблюдайте Условия использования
	Google и Политику запрещенного использования
	генеративного ИИ, а также проводите
	тщательное тестирование.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Внедрите надежные методы обеспечения
	безопасности в своем приложении:</b>
	Проверяйте все входные данные, полученные
	от объектов FunctionCall Gemini, прежде чем
	выполнять какие-либо файловые операции.
	Если ваше приложение обрабатывает или
	выполняет ненадежный код, предложенный
	LLM, внедрите надежные механизмы изоляции
	(например, контейнеры gVisor) для изоляции
	потенциально вредоносных действий от
	вашей хост-системы.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Используйте историю чата для отладки:</b>
	Используйте свойство Chat.history в Python SDK
	для проверки объектов FunctionCall и
	FunctionResponse. Это позволяет отслеживать
	точный поток взаимодействия между
	Gemini и инструментами вашего приложения,
	выявляя, где может произойти сбой.</p></li>
	<li><p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
	<b>Обращайтесь к кодам ошибок API:</b>
	Обратитесь к предоставленной таблице
	общих кодов ошибок Gemini API для диагностики
	проблем связи или конфигурации, которые
	могут проявляться как «отказы».</p></li>
</ol>
<h4 lang="zxx" class="western" style="border: none; padding: 0cm; background: transparent">
Источники</h4>
<p lang="zxx" style="margin-bottom: 0cm; line-height: 100%; border: none; padding: 0cm; background: transparent">
1. Gemini 2.5 Pro API: A Guide With Demo Project | DataCamp,
https://www.datacamp.com/tutorial/gemini-2-5-pro-api 2. Gemini 2.0
Deep Dive: Code Execution - Google Developers Blog,
https://developers.googleblog.com/en/gemini-20-deep-dive-code-execution/
3. Function_calling.ipynb - Colab,
https://colab.research.google.com/github/google-gemini/cookbook/blob/main/quickstarts/Function_calling.ipynb
4. Function calling with the Gemini API - YouTube,
https://www.youtube.com/watch?v=mVXrdvXplj0 5. Function calling using
the Gemini API | Firebase AI Logic - Google,
https://firebase.google.com/docs/ai-logic/function-calling 6. Files
API | Gemini API | Google AI for Developers,
https://ai.google.dev/gemini-api/docs/files 7. Using files | Gemini
API | Google AI for Developers, https://ai.google.dev/api/files 8.
Safety settings | Gemini API | Google AI for Developers,
https://ai.google.dev/gemini-api/docs/safety-settings 9. Safety
guidance | Gemini API | Google AI for Developers,
https://ai.google.dev/gemini-api/docs/safety-guidance 10. Understand
and use safety settings | Firebase AI Logic - Google,
https://firebase.google.com/docs/ai-logic/safety-settings 11. Agent
mode | Gemini for Google Cloud,
https://cloud.google.com/gemini/docs/codeassist/agent-mode 12.
Setting Up a Secure Python Sandbox for LLM Agents,
https://dida.do/blog/setting-up-a-secure-python-sandbox-for-llm-agents
13. Troubleshooting guide | Gemini API | Google AI for Developers,
https://ai.google.dev/gemini-api/docs/troubleshooting 14. Gemini API
quickstart | Google AI for Developers,
https://ai.google.dev/gemini-api/docs/quickstart 15. The 2.5pro API i
was using all of a sudden stopped working and now the new version
doesn't work also - Gemini Apps Community - Google Help,
https://support.google.com/gemini/thread/350529250/the-2-5pro-api-i-was-using-all-of-a-sudden-stopped-working-and-now-the-new-version-doesn-t-work-also?hl=en</p>
</body>
</html>